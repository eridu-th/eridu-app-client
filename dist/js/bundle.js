!function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={i:i,l:!1,exports:{}};return e[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(i,a,function(t){return e[t]}.bind(null,a));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";n.r(t);const i="https://eridu-app.herokuapp.com";var a={host:i,headerEndpoint:i+"/header",checkTokenEndpoint:i+"/checkToken",loginEndpoint:i+"/users/login",signupEndpoint:i+"/users",verifyEmailEndpoint:i+"/users/exist/email",verifyPhoneEndpoint:i+"/users/exist/phone",sendResetPasswordEndpoint:i+"/resetToken",verifyResetTokenEndpoint:i+"/resetToken/verify",resetPasswordEndpoint:i+"/resetToken/resetpassword"};async function o(){try{return await fetch(a.headerEndpoint,{method:"post",mod:"cors",headers:{"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>e)}catch(e){return console.log(e),null}}function s(){return sessionStorage.getItem("token")||localStorage.getItem("token")||null}async function r(e=""){let t=!1;if(e){const n=await o();200===(await fetch(a.checkTokenEndpoint,{method:"post",headers:{Authorization:e,"Content-type":"application/json","client-token":n["client-token"],"time-stamp":n["time-stamp"],"time-signature":n["time-signature"]}}).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode&&(t=!0)}return t}const c=document.querySelector(".container");function l(){sessionStorage.clear(),localStorage.clear(),window.location.hash="",c.innerHTML='\n        <div id="login_form">\n            <div id="eridu_logo">\n                <img src="https://i.imgur.com/iHPqdEf.png" alt="eridu_logo">\n            </div>\n            <form action="" autocomplete="off">\n                <div class="mb-3">\n                    <label for="email" class="form-label">Email</label>\n                    <input type="text" class="form-control" id="email" aria-describedby="emailHelp"\n                        autocomplete="off">\n                    <div class="invalid-feedback">Your email is not correct</div>\n                </div>\n                <div class="mb-3">\n                    <label for="password" class="form-label">Password</label>\n                    <input type="password" class="form-control" id="password">\n                    <div class="invalid-feedback">Your password is not correct</div>\n                </div>\n                <div class="mb-3 form-check">\n                    <input type="checkbox" class="form-check-input" id="remember_me" checked>\n                    <label class="form-check-label" for="remember_me">Remember me</label>\n                </div>\n                <button type="submit" class="btn btn-primary">Login</button>\n                <div>\n                    <div>\n                    <a href="#signup">Sign Up</a>\n                    </div>\n                    <div>\n                    <a href="#forgetpassword">Forget Password?</a>\n                    </div>\n                </div>\n            </form>\n        </div>\n    ';const e=document.querySelector("#login_form"),t=document.querySelector("#email"),n=document.querySelector("#password"),i=document.querySelector("#remember_me");function s(){n.classList.remove("is-invalid"),t.classList.remove("is-invalid")}t.addEventListener("input",s),n.addEventListener("input",s),e.addEventListener("submit",(async function(e){e.preventDefault();const s=t.value,r=n.value;if(s&&r){if(s&&r){if(await async function(e="",t="",n=!1){const i=await o(),s=await fetch(a.loginEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":i["client-token"],"time-stamp":i["time-stamp"],"time-signature":i["time-signature"]},body:JSON.stringify({email:e,password:t,keepAlive:n?1:0})}).then(e=>e.json()).then(e=>e).catch(e=>e);return 200===s.resCode?(n?(localStorage.setItem("token",s.token),localStorage.setItem("user",s.user)):(sessionStorage.setItem("token",s.token),sessionStorage.setItem("user",s.user)),window.location.hash="dashboard",!0):(console.log(s),!1)}(s,r,i.checked))return}t.classList.add("is-invalid"),n.classList.add("is-invalid")}else t.classList.add("is-invalid"),n.classList.add("is-invalid")}))}function d(e,t=window.location.href){e=e.replace(/[\[\]]/g,"\\$&");const n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}async function u(e){this.classList.remove("is-invalid"),this.classList.remove("is-valid");const t=e.target.value;if(t){const e=await o();200===(await fetch(a.verifyEmailEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":e["client-token"],"time-stamp":e["time-stamp"],"time-signature":e["time-signature"]},body:JSON.stringify({email:t})}).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode?this.classList.add("is-valid"):this.classList.add("is-invalid")}}async function p(e){this.classList.remove("is-invalid"),this.classList.remove("is-valid");const t=e.target.value;if(t){const e=await o();200===(await fetch(a.verifyPhoneEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":e["client-token"],"time-stamp":e["time-stamp"],"time-signature":e["time-signature"]},body:JSON.stringify({phone:t})}).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode?this.classList.add("is-valid"):this.classList.add("is-invalid")}}function m(e="",t="",n=null,i=null){if(!(e&&t&&i&&n))return null;n.innerText="Status: "+e,"pending"===e?(i.setAttribute("href","#search/trackingid?id="+t),i.innerText="Update Delivery Status"):"delivered"===e?(i.setAttribute("href",`${a.appEndpoint}/tracking?t=${t}`),i.innerText="Check Parcel POD"):(i.setAttribute("href","#search/trackingid?id="+t),i.innerText="Search Parcel")}async function f(e=""){const t=/.?(([Ee][Xx]|[Ss][Tt]|[Pp]{2})\d{13}).?/g.exec(e)[1].toUpperCase();if(t){const e=await o(),n=await fetch(a.searchParcelById,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","User-Token":""+(localStorage.getItem("token")||sessionStorage.getItem("token")),"Client-Token":e["Client-Token"],"Time-Stamp":e["Time-Stamp"],"Time-Signature":e["Time-Signature"]},body:JSON.stringify({trackingId:t})}).then(e=>e.json()).then(e=>e).catch(e=>e);return{trackingId:n[0].shipmentID,status:n[0].status}}return null}async function v(e=""){if(e){const t=localStorage.getItem("token"),n=await o(),i=await fetch(a.checkPreprintIdEndpoint,{method:"post",mod:"cors",responseType:"json",headers:{"Content-Type":"application/json","User-Token":""+t,"Client-Token":n["Client-Token"],"Time-Stamp":n["Time-Stamp"],"Time-Signature":n["Time-Signature"]},body:JSON.stringify({qr:e})}).then(e=>e.json()).then(e=>e).catch(e=>e);return console.log(i),i}return null}const h={rearCameras:[],cameras:[],appleDevice:null,scanning:!1,video:null,stream:null};async function g(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n        <div id="header">QR Reader</div>\n    ';const t=document.querySelector(".container");t.style.justifyContent="space-between",t.innerHTML='\n        <div id="qrcode_scanner">\n            <div id="videoSelect">\n                <label for="videoSource">Change Camera</label>\n                <select id="videoSource" class="custom-select"></select>\n            </div>\n            <canvas id="qr-canvas" hidden></canvas>\n            <div id="qr-result">\n                <b>Result: </b>\n                <p id="output_data">https://app.makesend.asia/tracking?t=PP2103151042875</p>\n                <p id="parcel_status">Status: <span>pending</span></p>\n            </div>\n            <div id="actionToResult">\n                <a href="#" class="btn btn-primary">action</a>\n                <hr>\n            </div>\n            <div id="startScanBtn">\n                <label>\n                    <img src="https://uploads.sitepoint.com/wp-content/uploads/2017/07/1499401426qr_icon.svg">\n                    <p>Scan Again</p>\n                </label>\n            </div>\n        </div>\n    ',h.video=document.createElement("video");const n=document.querySelector("#qr-canvas");n.width=n.offsetHeight/3*4;const i=n.getContext("2d"),a=document.querySelector("#qr-result"),o=document.querySelector("#videoSource"),s=document.querySelector("#actionToResult"),r=document.querySelector("#startScanBtn");async function c(){if(a.style.display="none",r.style.display="none",s.style.display="none",n.hidden=!1,/iphone|ipad|mac|apple|os\sx/.test(function(){let e=navigator.userAgent.match(/\((.*?)\)/g)[0];return e=e.slice(1,e.length-1),e}().toLowerCase())){try{h.stream&&h.stream.getTracks().forEach(e=>{e.stop()});const e=(await async function(){return await navigator.mediaDevices.getUserMedia({video:!0}).then(async e=>{const t=await navigator.mediaDevices.enumerateDevices();if(t.length){const e=t.filter(e=>"videoinput"===e.kind),n=o.value;return o.innerHTML="",e.forEach((e,t)=>{console.log(e);const n=document.createElement("option");n.value=e.deviceId,n.text=e.label||"camera "+(t+1),o.appendChild(n)}),o.value=n,t}p(),console.log("trigger")}).catch(p)}()).filter(e=>"videoinput"===e.kind&&/(back|rear)/g.test(e.label.toLowerCase()));let t={};const n=o.value;t=e.length?{video:{deviceId:n?{exact:n}:e[e.length-1].deviceId}}:{video:{deviceId:{exact:void 0}}},console.log(t),navigator.mediaDevices.getUserMedia(t).then(u).then(l).catch(p)}catch(e){p(e)}}else try{h.stream&&h.stream.getTracks().forEach(e=>{e.stop()});const e=o.value;let t=null;if(h.rearCameras.length)t={video:{deviceId:e?{exact:e}:{exact:h.rearCameras[h.rearCameras.length-1].deviceId}}},navigator.mediaDevices.getUserMedia(t).then(u).then(l).catch(p);else{t={video:{deviceId:void 0}};try{t={video:{facingMode:"environment"}},navigator.mediaDevices.getUserMedia(t).then(u).then(l).catch(p)}catch(e){console.log("no rear camera"),t={video:!0},navigator.mediaDevices.getUserMedia(t).then(u).then(l).catch(p)}}console.log(t)}catch(e){console.log(e)}}async function l(){const e=await navigator.mediaDevices.enumerateDevices().then(e=>e).catch(e=>e),t=e.filter(e=>"videoinput"===e.kind);if(t.length){const n=o.value;o.innerHTML="",t.forEach((e,t)=>{const n=document.createElement("option");n.value=e.deviceId,n.text=e.label||"camera "+(t+1),o.appendChild(n)}),o.value=n;const i=e.filter(e=>/(back|rear)/g.test(e.label.toLowerCase()));return h.rearCameras=i,e}p("This device has no available camera")}function u(e){h.stream=e,h.scanning=!0,h.video.setAttribute("playsinline",!0),h.video.srcObject=e,h.video.play(),g(),y()}function p(e){let t=`<h1>App can't start camera because </h1>\n            <p>"${e}"</p>\n            <div id="refresh_page" class="btn btn-light" style="margin: 0 auto;">Reload Page</div>`;document.querySelector("#qrcode_scanner").innerHTML=t,document.querySelector("#refresh_page").addEventListener("click",(function(e){e.stopPropagation(),location.reload()})),console.log(e)}function g(){h.scanning&&(n.height=h.video.videoHeight,n.width=h.video.videoWidth,i.drawImage(h.video,0,0,n.width,n.height),h.scanning&&requestAnimationFrame(g))}function y(){try{qrcode.decode()}catch(e){setTimeout(y,300)}}o.onchange=c,await l(),await c(),qrcode.callback=async function(e){e&&(a.style.display="block",r.style.display="block",h.scanning&&(h.video.srcObject.getTracks().forEach(e=>{e.stop()}),h.stream.getTracks().forEach(e=>{e.stop()})),h.scanning=!1,n.hidden=!0,async function(e){!async function(e=""){const t=d("id"),n=/.?(([Ee][Xx]|[Ss][Tt]|[Pp]{2})\d{13}).?/g.exec(e),i=document.querySelector("#output_data"),a=document.querySelector("#parcel_status");a.innerHTML="";const o=document.querySelector("#actionToResult");if(n){const s=n[1].toUpperCase();e.includes("http")?i.innerHTML=`\n            Parcel ID: <a href=${e}>${s}</a>\n            `:i.innerText=s,o.style.display="block";const r=o.querySelector("a");if(s.includes("ST"))r.setAttribute("href","#search?id="+s),r.innerText="Update Delivery Status";else if(s.includes("PP")){const e=await v(s);if(200===e.resCode&&e.registered){const{status:t}=await f(e.trackingID);m(t.toLowerCase(),e.trackingID,a,r)}else if(200===e.resCode){const e=t?"&parcelId="+t:"";r.setAttribute("href",`#register?id=${s}${e}`),r.innerText="Register Parcel",e&&e.includes("EX")&&(window.location.hash=`register?id=${s}${e}`)}else console.log(e.message),alert(e.message),i.innerText="Invalid Tracking ID "+s}else if(s.includes("EX")){const{status:e}=await f(s);m(e.toLowerCase(),s,a,r)}}else e.includes("http")||e.includes("www")?i.innerHTML=`\n           <a href=${e}>${e}</a>\n        `:i.innerText=e}(e.toString().trim().toLowerCase())}(e))},r.onclick=c}function y(e="dashboard"){const t=document.querySelector(".container"),n=document.querySelector("footer");t.innerHTML="",n.innerHTML='\n        <div class="navigator">\n            <div>\n                <a href="#scanner" class="" id="navi_scanner">\n                    <i class="fas fa-qrcode"></i>\n                    <span>Scan</span>\n                </a>\n            </div>\n            <div>\n                <a href="#search" class="" id="navi_search">\n                    <i class="fas fa-search"></i>\n                    <span>Search</span>\n                </a>\n            </div>\n            <div>\n                <a href="#tasks" class="" id="navi_tasks">\n                    <i class="fas fa-tasks"></i>\n                    <span>Tasks</span>\n                </a>\n            </div>\n            <div>\n                <a href="#setting" class="" id="navi_setting">\n                    <i class="fas fa-cog"></i>\n                    <span>Setting</span>\n                </a>\n            </div>\n        </div>\n    ',function(e){const t=document.querySelector("#navi_scanner"),n=document.querySelector("#navi_search"),i=document.querySelector("#navi_tasks"),a=document.querySelector("#navi_setting");switch([i,n,t,a].forEach(e=>{e.classList.remove("selected")}),e){case"dashboard":a.classList.add("selected");break;case"search":n.classList.add("selected");break;case"scanner":t.classList.add("selected");break;case"tasks":i.classList.add("selected");break;case"setting":a.classList.add("selected");break;default:a.classList.add("selected")}}(e)}const b={token:null,userEmail:null,emailVerified:!1,resetForm:null};async function w(){var e;(e=b).token=null,e.userEmail=null,e.emailVerified=!1,e.resetForm=null;document.querySelector(".container").innerHTML='\n    <div id="reset_password_form">\n        <div id="eridu_logo">\n        <img src="https://i.imgur.com/iHPqdEf.png" alt="eridu_logo">\n        </div>\n        <h1>Reset Password</h1>\n        <hr>\n        <div id="reset_password_input">\n        </div>\n        <hr>\n        <div id="backToLogin">\n            <a class="btn btn-secondary" href="#">Back to Login</a>\n        </div>\n    </div>\n    ';const t=new URLSearchParams(window.location.search).get("jwt");if(t){const e=await o();if(200===(await fetch(a.verifyResetTokenEndpoint,{method:"post",headers:{Authorization:t,"Content-type":"application/json","client-token":e["client-token"],"time-stamp":e["time-stamp"],"time-signature":e["time-signature"]}}).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode)return b.token=t,function(e){document.querySelector("#reset_password_input").innerHTML='\n        <form action="" autocomplete="off" id="reset_password_form">\n            <div class="mb-3">\n                <label for="password" class="form-label">New Password</label>\n                <input type="password" class="form-control" id="password" required>\n                <div class="invalid-feedback">Your password do not match</div>\n            </div>\n            <div class="mb-3">\n                <label for="password_repeat" class="form-label">Confirm password</label>\n                <input type="password" class="form-control" id="password_repeat" required>\n                <div class="invalid-feedback">Your password do not match</div>\n            </div>\n            <div>\n                <button type="submit" class="btn btn-primary">Reset Password</button>\n            </div>\n        </form>\n    ';const t=document.querySelector("#reset_password_form"),n=t.querySelector("button"),i=[...t.querySelectorAll("input")];i.forEach(e=>{e.oninput=function(){i.forEach(e=>{e.classList.remove("is-invalid")})}}),n.onclick=async function(t){t.preventDefault();const n=i.map(e=>e.value?e.value:null);if(n[0]===n[1]&&n[0]){const t=await async function(e="",t="",n=""){if(e&&n){const i=await o();return await fetch(a.resetPasswordEndpoint,{method:"post",mod:"cors",headers:{Authorization:n,"Content-Type":"application/json","client-token":i["client-token"],"time-stamp":i["time-stamp"],"time-signature":i["time-signature"]},body:JSON.stringify({password:e,confirmPassword:t})}).then(e=>e.json()).then(e=>e).catch(e=>e)}return null}(n[0],n[1],e.token);200===t.resCode?(alert(t.message),window.location.hash=""):(console.log(t.message),alert(t.message))}else i.forEach(e=>{e.classList.add("is-invalid")})}}(b)}!function(){const e=document.querySelector("#reset_password_input");if(e){const t='\n        <form action="" id="submit_email" class="form-group">\n            <div class="input-group mb-3">\n                <span class="input-group-text"><i class="fas fa-envelope"></i></span>\n                <input data-type="email" value="" type="email" inputmode="email" class="form-control"\n                    aria-label="email" placeholder="Email" required>\n                    <div class="valid-feedback">This email is valid!</div>\n                <div class="invalid-feedback">Something went wrong...Please check the email again!</div>\n            </div>\n            <button class="btn btn-primary">Reset Password</button>\n        </form>\n        ';e.innerHTML=t,b.resetForm=t;const n=e.querySelector("#submit_email");n.querySelector("input").onchange=function(e){return async function(t){this.classList.remove("is-invalid"),this.classList.remove("is-valid");const n=t.target.value;401===(await S(n)).resCode?(this.classList.add("is-valid"),e.emailVerified=!0,e.userEmail=n):this.classList.add("is-invalid")}}(b),n&&(n.onsubmit=k(b))}}()}async function S(e){if(e){const t=await o();return await fetch(a.verifyEmailEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":t["client-token"],"time-stamp":t["time-stamp"],"time-signature":t["time-signature"]},body:JSON.stringify({email:e})}).then(e=>e.json()).then(e=>e).catch(e=>e)}console.warn("'email' isn't given to checkEmail!")}function k(e){return async function(t=null){if(t&&t.preventDefault(),/(?:[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*|"(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21\x23-\x5b\x5d-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])*")@(?:(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?|\[(?:(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9]))\.){3}(?:(2(5[0-5]|[0-4][0-9])|1[0-9][0-9]|[1-9]?[0-9])|[a-z0-9-]*[a-z0-9]:(?:[\x01-\x08\x0b\x0c\x0e-\x1f\x21-\x5a\x53-\x7f]|\\[\x01-\x09\x0b\x0c\x0e-\x7f])+)\])/g.test(e.userEmail)){const t=document.querySelector("#reset_password_input");t.innerHTML='\n        <div id="reset_loader">\n            <div class="spinner-border text-primary" style="width:3rem; height:3rem;" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </div>\n            <h4>Loading...</h4>\n        </div>\n    ';const n={resCode:200,message:"success"};if(200===n.resCode){console.log(n),t.innerHTML=function(e=null){if(e)return`\n        <p>The reset link has been sent to ${e.userEmail}. Please reset your password in 10 mins!</p>\n        `;console.warn("'state' isn't given to emailIsSent!")}(e);const i=await o(),s=await fetch(a.sendResetPasswordEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":i["client-token"],"time-stamp":i["time-stamp"],"time-signature":i["time-signature"]},body:JSON.stringify({email:e.userEmail})}).then(e=>e.json()).then(e=>e).catch(e=>e);console.log(s)}else{t.innerHTML=e.resetForm;const i=t.querySelector("#submit_email"),a=i.querySelector("input");a.value=e.userEmail,a.classList.remove("is-invalid"),a.classList.remove("is-valid"),i.onsubmit=k,console.log(n.message),alert(n.message)}}else{const n=t.target.querySelector("input");if(n.value){401===(await S(n.value)).resCode&&(e.userEmail=n.value,k(e)())}else n.classList.add("is-invalid")}}}const T=a.uploadEndpoint;function _(e){const t=document.querySelector("footer");t.remove();const n=document.querySelector(".container"),i=document.createElement("div");i.className="modal-dialog modal-dialog-scrollable update-pod",i.innerHTML=`\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title" id="exampleModalScrollableTitle">Tracking ID: ${e}</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body">\n            <div id="signature_upload" class="signature-pad">\n                <div class="signature-pad--body">\n                    <canvas id="signature_canvas">This browser doesn't support canvas</canvas>\n                </div>\n                <div class="signature-pad--footer">\n                    <div class="description">Sign above</div>\n                    <div class="signature-pad--actions">\n                        <div>\n                            <button type="button" class="button clear" data-action="clear">Clear</button>\n                            <button type="button" class="button" data-action="undo">Undo</button>\n                        </div>\n                        <div>\n                            <button type="button" class="button save" data-action="save-png">Save\n                                as\n                                PNG</button>\n                            <button type="button" class="button save" data-action="save-jpg">Save\n                                as\n                                JPG</button>                            \n                        </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n        <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n            <button type="button" class="btn btn-primary" data-action="upload-signature">Upload</button>\n        </div>\n    </div>\n    `;n.appendChild(i);const a=i.querySelector("[data-action=clear]"),r=i.querySelector("[data-action=undo]"),c=i.querySelector("[data-action=save-png]"),d=i.querySelector("[data-action=save-jpg]"),u=i.querySelector("#signature_canvas"),p=new SignaturePad(u,{backgroundColor:"rgb(255, 255, 255)"});function m(){u.width=u.offsetWidth,u.height=u.offsetHeight,u.getContext("2d"),p.clear()}function f(e,t){const n=function(e){const t=e.split(";base64,"),n=t[0].split(":")[1],i=window.atob(t[1]),a=i.length,o=new Uint8Array(a);for(let e=0;e<a;++e)o[e]=i.charCodeAt(e);return new Blob([o],{type:n})}(e),i=window.URL.createObjectURL(n),a=document.createElement("a");a.style="display: none",a.href=i,a.download=t,document.body.appendChild(a),a.click(),window.URL.revokeObjectURL(i)}window.addEventListener("resize",m),m(),a.addEventListener("click",(function(e){p.clear()})),r.addEventListener("click",(function(e){const t=p.toData();t&&(t.pop(),p.fromData(t))})),c.addEventListener("click",(function(e){if(p.isEmpty())alert("Please provide a signature first.");else{f(p.toDataURL(),"signature.png")}})),d.addEventListener("click",(function(e){if(p.isEmpty())alert("Please provide a signature first.");else{f(p.toDataURL("image/jpeg"),"signature.jpg")}}));n.querySelector("[data-action=upload-signature]").onclick=async function(t){const n=p.toDataURL("image/jpeg"),i=s();if(i){const t=await o(),a=await fetch(T,{method:"post",headers:{"Content-Type":"application/json","User-Token":""+i,"Client-Token":t["Client-Token"],"Time-Stamp":t["Time-Stamp"],"Time-Signature":t["Time-Signature"]},body:JSON.stringify({trackingID:e,type:"signature",PODImage:[n],fileName:"signatuer_"+e})}).then(e=>e.json()).then(e=>e).catch(e=>alert(e));if(200===a.resCode&&a.result.length){const t=`upload signature for ${e} success!`;console.log(t),alert(t),v()}else{const t=`Error! Upload signature for ${e} failed!`;console.log(t),alert(t)}}else alert("token is invalid!"),l()};n.querySelector(".modal-header button").onclick=v;function v(){i.remove(),n.insertAdjacentElement("afterend",t)}n.querySelector(".modal-footer button").onclick=v}const q=a.uploadEndpoint,L={files:[],compressedFiles:[]};function x(e){const t=document.querySelector("footer");t.remove();const n=document.querySelector(".container"),i=document.createElement("div");i.className="modal-dialog modal-dialog-scrollable update-pod",i.innerHTML=`\n    <div class="modal-content">\n        <div class="modal-header">\n            <h5 class="modal-title" id="exampleModalScrollableTitle">Tracking ID: ${e}</h5>\n            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>\n        </div>\n        <div class="modal-body">\n            <div id="photo_upload">\n                <div class="custom-file-container" data-upload-id="imageUploader">\n                    <div class="image-upload-btns">\n                        <label class="custom-file-container__custom-file card shadow bg-white roundedcard shadow bg-white rounded">\n                            <div id="photo_btn">\n                                <img src="https://img.icons8.com/plasticine/camera.png" alt="photo_button">\n                                <p>Take a photo</p>\n                            </div>\n                            <input type="file" class="custom-file-container__custom-file__custom-file-input"\n                                accept="image/jpeg, image/png, image/gif" multiple aria-label="Choose File" style="display:none" />\n                            <input type="hidden" name="MAX_FILE_SIZE" value="10485760" style="display:none" />\n                            <span class="custom-file-container__custom-file__custom-file-control" style="display:none"></span>\n                        </label>\n                        \n                    </div>\n                    <div class="custom-file-container__image-preview"></div>\n                    <label><span>Remove All Photos</span>\n                            <a href="javascript:void(0)" class="custom-file-container__image-clear"\n                                title="Clear Image">&times;</a>\n                        </label>\n                </div>\n            </div>\n        </div>\n        <div class="modal-footer">\n            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>\n            <button type="button" class="btn btn-primary" data-action="upload-image">Upload</button>\n        </div>\n    </div>\n    `,n.appendChild(i);let a=new FileUploadWithPreview("imageUploader");n.querySelector("[data-action=upload-image]").onclick=async function(t){const n=a.cachedFileArray;n.length&&n.forEach(t=>{const i=new FileReader;i.readAsDataURL(t),i.onload=function(t){const i=document.createElement("img");i.src=t.target.result,i.onload=function(t){const i=document.createElement("canvas"),c=400/t.target.width;i.width=400,i.height=t.target.height*c;const l=i.getContext("2d");l.drawImage(t.target,0,0,i.width,i.height);const d=l.canvas.toDataURL(t.target,"image/jpeg",.92);L.compressedFiles.push(d),L.compressedFiles.length===n.length&&async function(t=[],n){const i=s(),a=await o();i?await fetch(q,{method:"post",headers:{"Content-Type":"application/json","User-Token":""+i,"Client-Token":a["Client-Token"],"Time-Stamp":a["Time-Stamp"],"Time-Signature":a["Time-Signature"]},body:JSON.stringify({trackingID:e,type:"image",PODImage:t,fileName:`pod_${e}_${(new Date).toISOString()}`})}).then(e=>e.json()).then(t=>{if(200===t.resCode&&t.result.length){const i=t.result.length>1?"images":"image",a=`upload ${t.result.length} ${i} for ${e} success!`;console.log(a),alert(a),n.clearPreviewPanel(),r()}else{const t=`upload image for ${e} failed`;console.log(t),alert(t)}}).catch(e=>{alert(e)}):(alert("token is invalid!"),userLogin())}(L.compressedFiles,a)}}})};n.querySelector(".modal-header button").onclick=r;function r(){i.remove(),n.insertAdjacentElement("afterend",t)}n.querySelector(".modal-footer button").onclick=r}const C=""+a.searchParcelByPhone,E=""+a.searchParcelById,P={input:"",timeoutId:null,parcels:[]};function j(){document.querySelector("form").onsubmit=function(e){e.preventDefault(),M()}}function I(){document.querySelector("input").oninput=function(e){P.input=e.target.value,document.querySelector("#result_list ul").innerHTML="",P.timeoutId&&clearTimeout(P.timeoutId);const t=setTimeout((function(){M()}),300);P.timeoutId=t}}function M(){const e=document.querySelector("input");"receiver_phone"===e.id?async function(e){if(e.match(/^0\d{9}/g))try{const t=await o(),n=await fetch(C,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","User-Token":""+(localStorage.getItem("token")||sessionStorage.getItem("token")),"Client-Token":t["Client-Token"],"Time-Stamp":t["Time-Stamp"],"Time-Signature":t["Time-Signature"]},body:JSON.stringify({receiver_phone:e})}).then(e=>e.json()).then(e=>e);P.parcels=n.map(e=>{const t=new Date(Date.parse(e.service_date)).toLocaleDateString().split("/");return e.service_date=`${t[2]}-${t[0]}-${t[1]}`,e}),P.parcels.length?O():$()}catch(e){R(e)}else{H("Phone number starts with 0 and is in 10 digits!")}}(P.input):"tracking_id"===e.id&&D(P.input)}async function D(e){const t=/^[eE][xX]\d{13}/g.exec(e);if(t)try{const e=await o(),n=await fetch(E,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json","User-Token":""+(localStorage.getItem("token")||sessionStorage.getItem("token")),"Client-Token":e["Client-Token"],"Time-Stamp":e["Time-Stamp"],"Time-Signature":e["Time-Signature"]},body:JSON.stringify({trackingId:t[0]})}).then(e=>e.json()).then(e=>e);if(P.parcels=n.map(e=>{const t=new Date(Date.parse(e.service_date)).toLocaleDateString().split("/");return e.service_date=`${t[2]}-${t[0]}-${t[1]}`,e}),P.parcels.length)return O(),n;$()}catch(e){R(e)}else{H("Your tracking ID is invalid!")}}function H(e){document.querySelector("#result_list ul").innerHTML='\n    <li id="input_error" class="list-group-item" style="color: red; font-weight: bold;"></li>\n    ',document.querySelector("#input_error").innerText=e}function $(){document.querySelector("#result_list ul").innerHTML='\n    <li id="input_error" class="list-group-item" style="color: red; font-weight: bold;"></li>\n    ',document.querySelector("#input_error").innerText=`No result from "${P.input}"`}function O(){console.log(P.parcels);const e=P.parcels.map(e=>{let t="",n="";switch(e.status.toLowerCase().trim()){case"pending":case"in hub":case"delivering":case"delivering (delay)":case"returning":case"re-deilvering":t="primary";break;case"delivered":case"delivered (delay)":case"returned":t="primary",n="disabled";break;case"canceled":case"failed delivery":case"not found":t="danger",n="disabled";break;default:t="primary"}return`\n        <li class="list-group-item">\n            <div class="card" data-shipment-id="${e.shipmentID}">\n                <div class="card-body">\n                    <h5 class="card-title">Parcel ID: ${e.shipmentID}</h5>\n                    <h6 class="card-subtitle mb-2 text-muted">Service Date: ${e.service_date}</h6>\n                    <h6 class="card-subtitle mb-2 text-muted">Delivery Status: ${e.status}</h6>\n                    <p class="card-text">${e.receiver_name} ${e.receiver_no}</p>\n                    <p class="card-text">${e.dropoff_address}, ${e.dropoff_district}, ${e.dropoff_province} ${e.dropoff_postcode}</p>\n                    <p class="card-text">${e.note}</p>\n                    <div class="card-link btn btn-${t} ${n}" data-type="photo">Photo</div>\n                    <div class="card-link btn btn-${t} ${n}" data-type="signature">Singature</div>\n                </div>\n            </div>\n        </li>\n        `}).join("");document.querySelector("#result_list ul").innerHTML=e;[...document.querySelector(".list-group.list-group-flush").children].forEach(e=>{const t=e.querySelector(".card");e.querySelector("div[data-type=signature]").addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),_(t.dataset.shipmentId)}));e.querySelector("div[data-type=photo]").addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),x(t.dataset.shipmentId)}))})}function R(e){const t=document.querySelector("header");t.innerHTML=`\n    <div id="warning" class="alert alert-danger" role="alert">\n        Something went wrong: ${e}\n    </div>\n    `,setTimeout((function(){t.innerHTML=""}),30)}const U={id:null,parcelId:null};function A(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n        <div id="header">SETTINGS</div>\n    ';const t=document.querySelector(".container");t.style.justifyContent="space-between",t.innerHTML='\n        <div id="setting">\n            <div id="search_setting">\n                <form action="">\n                    <input id="search_input" type="text" name="search_input" value="" placeholder="Search Setting...">\n                    <button type="submit"><i class="fa fa-search"></i></button>\n                </form>\n            </div>\n            <div id="setting_list">\n                <h3>Account Setting</h3>                        \n                <ul class="list-group list-group-flush">\n                <li class="list-group-item">\n                    <a href="#setting/userprofile">\n                        <div>\n                            <i class="fas fa-user"></i>\n                        </div>\n                        <div>User Profile</div>\n                        <div>\n                            <i class="fas fa-greater-than"></i>\n                        </div>\n                    </a>\n                </li>\n                <li class="list-group-item">\n                    <a href="#setting/resetpassword">\n                        <div>\n                            <i class="fas fa-lock"></i>\n                        </div>\n                        <div>Reset Password</div>\n                        <div>\n                            <i class="fas fa-greater-than"></i>\n                        </div>\n                    </a>\n                </li>\n                <li class="list-group-item">\n                    <a href="#setting/about">\n                        <div>\n                            <i class="fas fa-question-circle"></i>\n                        </div>\n                        <div>About</div>\n                        <div>\n                            <i class="fas fa-greater-than"></i>\n                        </div>\n                    </a>\n                </li>\n                </ul>\n            </div>\n            <div>\n                <div id="logout_btn" class="btn btn-secondary">\n                    <div><i class="fas fa-sign-out-alt"></i></div>\n                    <div>Logout</div>\n                </div>\n            </div>\n        </div>\n    ';!function(e){const t=document.querySelector("footer"),n=document.querySelector(".container");e.onclick=function(e){e.stopPropagation(),sessionStorage.clear(),localStorage.clear(),t.innerHTML="",n.style.justifyContent="center",window.location.hash=""}}(document.querySelector("#logout_btn"))}const N={otp:"",ref:"",pending:60,timeStamp:0,countdownTimer:null,redirectCountdownTimer:null,step:1};function J(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n    <div id="header">reset password</div>\n    ';document.querySelector("#setting").innerHTML='\n        <div>\n            <div class="progress-container">\n                <div class="progress" id="progress"></div>\n                <div class="circle active">\n                    1\n                </div>\n                <div class="circle">\n                    2\n                </div>\n                <div class="circle">\n                    3\n                </div>\n                <div class="circle">\n                    4\n                </div>\n            </div>\n            <h1>Request OTP</h1>\n        </div>\n        <div id="phone_otp_input_login">\n            <button class="btn btn-warning">Request OTP <span></span></button>\n        </div>\n        <div>\n            <a href="#setting" class="btn btn-primary">Back To Setting</a>\n        </div>\n        ',function(){F(N.step);const e=document.querySelector("#phone_otp_input_login"),t=e.querySelector("button");if(e&&t){t.onclick=async function(t){t.stopPropagation(),e.innerHTML=Y();const n=await o(),i={method:"post",mod:"cors",headers:{"Content-Type":"application/json","User-Token":""+s(),"Client-Token":n["Client-Token"],"Time-Stamp":n["Time-Stamp"],"Time-Signature":n["Time-Signature"]}},r=await fetch(a.loginRequestOTPEndpoint,i).then(e=>e.json()).then(e=>e).catch(e=>e);200===r.resCode?(N.ref=r.otpRef,N.timeStamp=(new Date).getTime(),e.innerHTML=X(),N.step+=1,F(N.step),z(),function e(){const t=document.querySelector("#phone_otp_input_login"),n=document.querySelector(".digit-group").querySelectorAll("input");n.length&&(n[0].focus(),n.forEach(n=>{n.onchange=async function(n){const i=this.parentNode,r=n.target.value;if(document.querySelector("#invalid_otp_login").innerText="",r){const e=i.querySelector("input#"+this.dataset.next);e&&e.focus()}else if(r){if(N.otp="",formTag.querySelectorAll("input").forEach(e=>{N.otp+=e.value}),4===N.otp.length){t.innerHTML=Y();const n=await o(),i={method:"post",mod:"cors",headers:{"Content-Type":"application/json","User-Token":""+s(),"Client-Token":n["Client-Token"],"Time-Stamp":n["Time-Stamp"],"Time-Signature":n["Time-Signature"]},body:JSON.stringify({otp:N.otp,ref:N.ref})};if(200===(await fetch(a.loginVerifyOTPEndpoint,i).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode)N.step+=1,F(N.step),B();else{t.innerHTML=X(N.pending);document.querySelector("#invalid_otp_login").innerText="Invalid OTP Code!",e(),z()}}}else{const e=i.querySelector("input#"+this.dataset.previous);e&&e.focus()}},n.onkeyup=async function(n){const i=this.parentNode,r=i.parentNode;if(document.querySelector("#invalid_otp_login").innerText="",8===n.keyCode||37===n.keyCode){const e=i.querySelector("input#"+this.dataset.previous);e&&e.focus()}else if(n.keyCode>=48&&n.keyCode<=57||n.keyCode>=65&&n.keyCode<=90||n.keyCode>=96&&n.keyCode<=105||39===n.keyCode){const n=i.querySelector("input#"+this.dataset.next);if(n)n.focus();else if(N.otp="",r.querySelectorAll("input").forEach(e=>{N.otp+=e.value}),4===N.otp.length){t.innerHTML=Y();const n=await o(),i={method:"post",mod:"cors",headers:{"Content-Type":"application/json","User-Token":""+s(),"Client-Token":n["Client-Token"],"Time-Stamp":n["Time-Stamp"],"Time-Signature":n["Time-Signature"]},body:JSON.stringify({otp:N.otp,ref:N.ref})};if(200===(await fetch(a.loginVerifyOTPEndpoint,i).then(e=>e.json()).then(e=>e).catch(e=>e)).resCode)N.step+=1,F(N.step),B();else{t.innerHTML=X(N.pending);document.querySelector("#invalid_otp_login").innerText="Invalid OTP Code!",e(),z()}}}}}))}()):(console.log(r.message),alert(r.message),window.location.hash="setting")}}}()}function F(e=1){let t="";switch(e){case 1:t="request otp";break;case 2:t="verify otp";break;case 3:t="set new password";break;case 4:t="Success!";break;default:t="request otp"}const n=document.querySelector("#progress"),i=document.querySelectorAll(".circle");document.querySelector("#setting h1").innerText=t;let a=e;!function(){i.forEach((e,t)=>{t<a?e.classList.add("active"):e.classList.remove("active")});const e=document.querySelectorAll(".active");n.style.width=(e.length-1)/(i.length-1)*100+"%"}()}function z(e=60){N.countdownTimer&&clearTimeout(N.countdownTimer);const t=document.querySelector("#countdown");if(t){const e=(new Date).getTime();let n=N.pending,i=Math.floor((e-N.timeStamp)/1e3);if(i>=60?n=0:i<60&&60!==n&&(n=60-i),n>0)N.pending=n-1,t.innerText=N.pending,N.countdownTimer=setTimeout((function(){z(N.pending)}),1e3);else{const e=document.querySelector("#insert_otp_login button");e.removeAttribute("disabled"),t.parentNode.innerHTML="",e.onclick=function(t){t.preventDefault(),N.pending=60,e.setAttribute("disabled",!0),document.querySelector("#insert_otp_login button span").innerHTML=`(<span id="countdown">${N.pending}</span> sec)`,z(N.pending)}}}}function B(){const e=document.querySelector("#phone_otp_input_login");e.innerHTML='\n        <form action="" autocomplete="off" id="reset_password_form_login">\n            <div class="mb-3">\n                <label for="password" class="form-label">New Password</label>\n                <input type="password" class="form-control" id="password_login" required>\n                <div class="invalid-feedback">Your password do not match</div>\n            </div>\n            <div class="mb-3">\n                <label for="password_repeat" class="form-label">Confirm password</label>\n                <input type="password" class="form-control" id="password_repeat_login" required>\n                <div class="invalid-feedback">Your password do not match</div>\n            </div>\n            <div style="display:flex; justify-content: center; align-items: center;">\n                <button type="submit" class="btn btn-warning">Reset Password</button>\n            </div>\n        </form>\n    ';const t=document.querySelector("#reset_password_form_login"),n=t.querySelector("button"),i=[...t.querySelectorAll("input")];i[0].focus(),i.forEach(e=>{e.oninput=function(){i.forEach(e=>{e.classList.remove("is-invalid")})}}),n.onclick=async function(t){t.preventDefault();const n=i.map(e=>e.value?e.value:null);if(n[0]===n[1]&&n[0]){const t=await o(),i={method:"post",mod:"cors",headers:{"Content-Type":"application/json","User-Token":""+s(),"Client-Token":t["Client-Token"],"Time-Stamp":t["Time-Stamp"],"Time-Signature":t["Time-Signature"]},body:JSON.stringify({otp:N.otp,ref:N.ref,password:n[0],confirmPassword:n[1]})},r=await fetch(a.loginVerifyOTPEndpoint,i).then(e=>e.json()).then(e=>e).catch(e=>e);if(200===r.resCode){N.step+=1,F(N.step),console.log(r.message);let t=3;e.innerHTML=function(e="10"){return`\n        <div style="display: flex; flex-direction: column; justify-content: center; align-items: center;">\n            <img style="display:block; width: 50%; border-radius: 10px;" src="https://i.pinimg.com/originals/e8/06/52/e80652af2c77e3a73858e16b2ffe5f9a.gif">\n            <div>\n                <h2 style="text-align: center;">Success!</h2>\n            </div>\n            <div>\n                <p style="text-align: center;">Page redirect in <span id="redirect_countdown">${e}</span> seconds...</p>\n            </div>\n        </div>\n    `}(t),function e(t=10){const n=document.querySelector("#redirect_countdown");t>0?setTimeout((function(){n.innerText=t-1,e(t-1)}),1e3):N.redirectCountdownTimer&&clearTimeout(N.redirectCountdownTimer)}(t),setTimeout((function(){N.step=1,window.location.hash="setting"}),1e3*t)}else console.log(r.message),alert(r.message)}else i.forEach(e=>{e.classList.add("is-invalid")})}}function Y(){return'\n        <div id="otp_loader_login">\n            <div class="spinner-border text-warning" style="width:3rem; height:3rem;" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </div>\n            <h4>Loading...</h4>\n        </div>\n    '}function X(e=60){return`\n    <form class="digit-group" data-group-name="digits" autocomplete="off" id="insert_otp_login">\n        <div>\n            <h3>Enter OTP Code</h3>\n        </div>\n        <div>\n            <input autocomplete=off type="text" inputmode="numeric" id="digit-1" name="digit-1" data-next="digit-2" maxlength="1" />\n            <input autocomplete=off type="text" inputmode="numeric" id="digit-2" name="digit-2" data-next="digit-3" data-previous="digit-1"\n                maxlength="1" />\n            <input autocomplete=off type="text" inputmode="numeric" id="digit-3" name="digit-3" data-next="digit-4" data-previous="digit-2"\n                maxlength="1" />\n            <input autocomplete=off type="text" inputmode="numeric" id="digit-4" name="digit-4" data-previous="digit-3" maxlength="1" />\n        </div>\n        <div id="invalid_otp_login"></div>\n        <div>\n            <button class="btn btn-warning" type="submit" disabled>Request OTP <span>(<span id="countdown">${e}</span> sec)</span></button>\n        </div>\n    </form>\n    `}const V={name:"",email:"",phone:"",pending:60,countdownTimer:null};async function G(){const e=document.querySelector(".container");e.innerHTML=function(e="",t="",n=""){return`\n    <div id="signup_form">\n        <div>\n            <a href="#"><img src="https://i.imgur.com/iHPqdEf.png" alt="eridu_logo"></a>\n        </div>\n        <h1>Register</h1>\n        <div id="form_wrapper">\n            <form action="" id="eridu_signup_form" class="form-group">\n                <div class="input-group mt-3 mb-3">\n                    <span class="input-group-text"><i class="fas fa-user"></i></span>\n                    <input data-type="name" value="${e}" type="text" class="form-control" aria-label="name"\n                        placeholder="Your Name" required>\n                </div>\n                <div class="input-group mb-3">\n                    <span class="input-group-text"><i class="fas fa-envelope"></i></span>\n                    <input data-type="email" value="${t}" type="email" inputmode="email" class="form-control"\n                        aria-label="email" placeholder="Email" required>\n                    <div class="invalid-feedback">This Email is in use! Please choose another email</div>\n                    <div class="valid-feedback">This email is available!</div>\n                </div>\n                <div class="input-group mb-3">\n                    <span class="input-group-text"><i class="fas fa-phone-alt"></i></span>\n                    <input data-type="phone" value="${n}" type="number" inputmode="numeric" class="form-control"\n                        aria-label="phone number" placeholder="Phone Number" required>\n                    <div class="invalid-feedback">This phone number is in use! Please choose another one</div>\n                    <div class="valid-feedback">This phone number is available!</div>\n                </div>\n                <div class="input-group mb-3">\n                    <span class="input-group-text"><i class="fas fa-lock"></i></span>\n                    <input data-type="password" type="password" class="form-control" aria-label="new password"\n                        placeholder="New Password" required>\n                    <span class="input-group-text"><i class="fas fa-eye"></i></span>\n                    <div class="invalid-feedback">Your passwords do not match!</div>\n                </div>\n                <div class="input-group mb-3">\n                    <span class="input-group-text"><i class="fas fa-lock"></i></span>\n                    <input data-type="confirm_password" type="password" class="form-control"\n                        aria-label="confirm password" placeholder="Confirm Password" required>\n                    <span class="input-group-text"><i class="fas fa-eye"></i></span>\n                    <div class="invalid-feedback">Your passwords do not match!</div>\n                </div>            \n            </form>\n        </div>\n        <div>\n            <div><a class="btn btn-primary" href="#">Back</a></div>\n            <input value="Sign Up" type="submit" class="btn btn-warning" id="signup_next_step" form="eridu_signup_form">\n        </div>\n    </div>\n    `}(V.name,V.email,V.phone),[...document.querySelectorAll("input[type=password]")].forEach(e=>{e.parentNode.querySelectorAll("span")[1].onclick=function(e){e.stopPropagation();const t=this.parentNode.querySelector("input");"password"===t.type?(this.innerHTML='<i class="fas fa-eye-slash"></i>',t.type="text"):(this.innerHTML='<i class="fas fa-eye"></i>',t.type="password")}});e.querySelector("form").onsubmit=W,[...document.querySelectorAll("input[type=password]")].forEach(e=>{e.oninput=Q}),function(){const e=document.querySelector("input[data-type=email]"),t=document.querySelector("input[data-type=phone]");function n(){this.classList.remove("is-invalid"),this.classList.remove("is-valid")}e.oninput=n,t.oninput=n,e.onblur=u,t.onblur=p}(),function(){const e=document.querySelector("input[data-type=password]"),t=document.querySelector("input[data-type=confirm_password]");function n(n){e.value.trim()&&t.value.trim()&&e.value!==t.value&&(e.classList.add("is-invalid"),t.classList.add("is-invalid"))}e.onchange=n,t.onchange=n}()}async function W(e){e.preventDefault();const t=[...document.querySelectorAll("input")].reduce((e,t)=>(e[t.dataset.type]=t.value,e),{});if(V.name=t.name,V.email=t.email,V.phone=t.phone,t.password===t.confirm_password){const e=document.querySelector("#form_wrapper");e.style.justifyContent="center",e.innerHTML=Z();const n=document.querySelector("#signup_form > div:last-child");n.style.display="none";const i=await o();let s=await fetch(a.signupEndpoint,{method:"post",headers:{"Content-type":"application/json","client-token":i["client-token"],"time-stamp":i["time-stamp"],"time-signature":i["time-signature"]},body:JSON.stringify({name:t.name,email:t.email,phone:t.phone,password:t.password})}).then(e=>e.json()).then(e=>e).catch(e=>e);201===s.resCode?(console.log("signup success"),n.style.display="flex",window.location.hash="#dashboard",localStorage.setItem("token",s.token)):(console.log(s.message),alert(s.message),e.style.justifyContent="flex-start",G())}else!function(){const e=document.querySelector("input[data-type=password]"),t=document.querySelector("input[data-type=confirm_password]");e.classList.add("is-invalid"),t.classList.add("is-invalid")}()}function Q(){const e=document.querySelector("input[data-type=password]"),t=document.querySelector("input[data-type=confirm_password]");e.classList.remove("is-invalid"),t.classList.remove("is-invalid")}function Z(){return'\n        <div id="regiser_form_loader">\n            <div class="spinner-border text-warning" style="width:3rem; height:3rem;" role="status">\n                <span class="visually-hidden">Loading...</span>\n            </div>\n            <h4>Loading...</h4>\n        </div>\n    '}function K(e=null){if(e){new URLSearchParams(window.location.search).get("jwt")&&!e.redirected&&(window.location.hash="forgetpassword/reset",e.redirected=!0);const t=window.location.hash.toLowerCase();t.includes("forgetpassword")?w():t.includes("signup")?G():l()}}window.onload=async function(){const e={redirected:!1},t=localStorage.getItem("token")||sessionStorage.getItem("token");if(t){await r(t)?(window.location.hash="setting",document.querySelector("header").style.display="block",y("setting"),A()):l()}else K(e);window.onhashchange=async function(){const t=localStorage.getItem("token")||sessionStorage.getItem("token"),n=window.location.hash.toLowerCase();console.log("path changes! "+n),function(){if(h.scanning){h.video&&h.video.srcObject.getTracks().forEach(e=>{e.stop()}),h.stream&&h.stream.getTracks().forEach(e=>{e.stop()}),h.scanning=!1,h.video=null,h.stream=null;document.querySelector("#qr-canvas").hidden=!0}}(),document.querySelector("header").style.display="none";await r(t)?n.includes("#dashboard")?window.location.hash="setting":n.includes("#scanner")?(y("scanner"),g()):n.includes("#search")?(y("search"),function(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n        <div id="header">Search parcel</div>\n    ';const t='\n    <form action="">\n        <input class="form-control" id="receiver_phone" type="tel" name="receiver_phone" value=""\n            inputmode="numeric" placeholder="#0632166699" autocomplete="off" pattern="[0-9]{10}">\n        <button type="submit"><i class="fa fa-search"></i></button>\n    </form>\n    ';let n=t;const i=window.location.hash.split("?")[0];U.id=d("id"),U.parcelId=d("parcelId");let a="primary",o="dark";i.includes("trackingid")?(n='\n    <form action="" class="form-group">\n        <input class="form-control" id="tracking_id" type="text" name="tracking_id" value=""\n            placeholder="#EX1234567890123" autocomplete="off">\n        <button type="submit"><i class="fa fa-search"></i></button>        \n    </form>\n    ',a="dark",o="primary"):n=t;const s=document.querySelector(".container");if(s.style.justifyContent="space-between",s.innerHTML=`\n    <div id="search_parcel">\n        <div id="search_functions">\n            <div id="search_by_phone_btn" class="btn btn-${a}">Receiver Phone</div>\n            <div id="search_by_tracking_id_btn" class="btn btn-${o}">Tracking ID</div>\n        </div>\n        <div id="search_list">\n            <div id="search_bar">\n                ${n}\n            </div>            \n        </div>\n        <div id="search_filters">\n        </div>\n        <div id="result_list">\n            <ul class="list-group list-group-flush">\n                <li class="list-group-item">Please search parcel by <br> <b>Receiver Phone</b> or <br> <b>Tracking ID</b></li>\n            </ul>\n        </div>\n    </div>\n    `,j(),I(),U.id){document.querySelector("#search_bar").querySelector("input").value=U.id,D(U.id)}const r=document.querySelector("#search_by_phone_btn"),c=document.querySelector("#search_by_tracking_id_btn");function l(e){e.stopPropagation();[...this.parentNode.children].forEach(e=>{e===this?(e.classList.add("btn-primary"),e.classList.remove("btn-dark")):(e.classList.add("btn-dark"),e.classList.remove("btn-primary"))}),"search_by_tracking_id_btn"===this.id?(document.querySelector("#search_by_tracking_id_btn").classList.add("btn-primary"),document.querySelector("#search_by_phone_btn").classList.add("btn-dark"),window.location.hash="search/trackingid"):"search_by_phone_btn"===this.id&&(window.location.hash="search/phone"),document.querySelector("#result_list ul").innerHTML='<li class="list-group-item">Please search parcel by <br> <b>Receiver Phone</b> or <br> <b>Tracking ID</b></li>',j(),I()}r.addEventListener("click",l),c.addEventListener("click",l)}()):n.includes("#tasks")?y("tasks"):n.includes("#setting")?n.includes("userprofile")?function(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n        <div id="header">user profile</div>\n    ',document.querySelector("#setting").innerHTML='\n        <div>\n        \n        </div>\n        <div>\n            \n        </div>\n        <div>\n            <a href="#setting" class="btn btn-primary">Back To Setting</a>\n        </div>\n    '}():n.includes("resetpassword")?J():n.includes("about")?function(){const e=document.querySelector("header");e.style.display="block",e.innerHTML='\n        <div id="header">user profile</div>\n    ',document.querySelector("#setting").innerHTML='\n        <div>\n        \n        </div>\n        <div>\n            \n        </div>\n        <div>\n            <a href="#setting" class="btn btn-primary">Back To Setting</a>\n        </div>\n    '}():(y("setting"),A()):window.location.hash="":K(e)}}}]);